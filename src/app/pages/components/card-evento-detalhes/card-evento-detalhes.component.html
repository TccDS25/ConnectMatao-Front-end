<app-navbar></app-navbar>

<div *ngIf="event" class="event-container">
  <!-- Banner com imagem -->
  <div class="event-banner">
    <img *ngIf="event.imagens"
       [src]="'data:image/jpeg;base64,' + event.imagens[0]"
       alt="Imagem do evento"
    />
    <!-- Botões de Like e Dislike sobre a imagem -->
    <div class="like-dislike-container">
      <button (click)="toggleLike()" [class.liked]="usuarioInteragiu === 1">
        👍 {{ likesCount }}
      </button>

      <button
        (click)="toggleDislike()"
        [class.disliked]="usuarioInteragiu === 2"
      >
        👎 {{ dislikesCount }}
      </button>
    </div>
  </div>

  <!-- Card com detalhes -->
  <div class="event-card">
    <h2>{{ event.titulo }}</h2>
    <p class="event-description">
      <strong>Descrição:</strong>
      {{ event.descricao || "Sem descrição disponível." }}
    </p>

    <div class="card-footer">
      <p class="event-address">
        <strong>Endereço:</strong>
        <ng-container
          *ngIf="
            event.logradouro || event.numero || event.bairro || event.cep;
            else noAddress
          "
        >
          {{ event.logradouro }}, {{ event.numero }} – {{ event.bairro }} – CEP:
          {{ event.cep }}
        </ng-container>
        <ng-template #noAddress>Não informado</ng-template>
      </p>
      <p class="age-rating">
        <strong>Faixa Etária:</strong>
        {{ event.faixaEtaria === 0 ? "Todas" : event.faixaEtaria }}
      </p>
      <p class="event-date">
        <strong>Data e Horário:</strong>
        {{ event.data | date : "dd/MM/yyyy" }} – {{ event.horario }}
      </p>
    </div>
  </div>

  <!-- Informações do usuário no final -->
  <div class="user-info-footer">
    <img
      *ngIf="usuario?.imagem"
      [src]="'data:image/png;base64,' + usuario?.imagem"
      alt="Foto de perfil de {{ usuario?.nome }}"
      class="user-profile-img"
      (click)="openModal()"
    />
    <h3>{{ usuario?.nome }}</h3>
  </div>
</div>

<!-- Spinner de carregamento -->
<mat-spinner *ngIf="isLoading" class="spinner-overlay"></mat-spinner>

<!-- Modal de imagem do usuário -->
<div *ngIf="modalOpen" class="modal" (click)="closeModal()">
  <div class="modal-content" (click)="$event.stopPropagation()">
    <img
      *ngIf="usuario?.imagem"
      [src]="'data:image/png;base64,' + usuario?.imagem"
      alt="Foto de perfil de {{ usuario?.nome }}"
      class="event-logo-modal"
    />
    <button class="close-btn" (click)="closeModal()">×</button>
  </div>
</div>
