<app-navbar></app-navbar>

<div *ngIf="event" class="event-container">
  <div
    class="event-banner"
    [style.background-image]="'url(' + event?.imagem + ')'"
  >
    <div class="overlay"></div>

    <!-- Exibindo a imagem do usuário -->
    <img
      *ngIf="usuario?.imagem"
      [src]="'data:image/png;base64,' + usuario?.imagem"
      alt="Foto de perfil de {{ usuario?.nome }}"
      class="event-logo"
      (click)="openModal()"
    />

    <div class="event-info">
      <h3>{{ usuario?.nome }}</h3>
      <p>{{ event?.data | date : "dd/MM/yyyy" }} - {{ event?.horario }}</p>
    </div>
  </div>

  <div class="event-card">
    <h2>{{ event?.titulo }}</h2>

    <p class="event-description">
      <strong>Descrição:</strong>
      {{ event?.descricao || "Sem descrição disponível." }}
    </p>

    <div class="card-footer">
      <p class="event-address">
        <strong>Endereço:</strong>
        <ng-container
          *ngIf="
            event.logradouro || event.numero || event.bairro || event.cep;
            else enderecoNaoInformado
          "
        >
          {{ event?.logradouro || "" }}, {{ event?.numero || "" }} -
          {{ event?.bairro || "" }} - CEP: {{ event?.cep || "" }}
        </ng-container>
        <ng-template #enderecoNaoInformado>Não informado</ng-template>
      </p>

      <p class="age-rating">
        <strong>Faixa Etária:</strong>
        {{ event?.faixaEtaria === 0 ? "Todas" : event?.faixaEtaria }}
      </p>

      <!-- Like and Dislike Buttons -->
      <!-- Se quiser reabilitar os botões de like e dislike, basta descomentar a seção abaixo -->
      <!-- <div class="like-dislike-container">
        <button class="like-button" (click)="likeEvento()" aria-label="Curtir">
          <span [ngClass]="{ liked: event.usuarioInteragiu === 1 }">👍</span>
          <span class="like-count">{{ event.likes }}</span>
        </button>

        <button
          class="dislike-button"
          (click)="dislikeEvento()"
          aria-label="Não curtir"
        >
          <span [ngClass]="{ disliked: event.usuarioInteragiu === 2 }">👎</span>
          <span class="dislike-count">{{ event.deslikes }}</span>
        </button>
      </div> -->
    </div>
  </div>
</div>

<!-- Spinner de Carregamento -->
<mat-spinner *ngIf="isLoading" class="spinner-overlay"></mat-spinner>

<!-- Modal de Imagem do Usuário -->
<div
  *ngIf="modalOpen"
  class="modal"
  aria-modal="true"
  role="dialog"
  (click)="closeModal()"
>
  <div class="modal-content" (click)="$event.stopPropagation()">
    <img
      *ngIf="usuario?.imagem"
      [src]="'data:image/png;base64,' + usuario?.imagem"
      alt="Foto de perfil de {{ usuario?.nome }}"
      class="event-logo-modal"
    />
    <button class="close-btn" aria-label="Fechar" (click)="closeModal()">
      ×
    </button>
  </div>
</div>
